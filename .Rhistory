ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1) +
geom_col(color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = c("lightblue", "orange")) +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = c( "orange","lightblue")) +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = c( "orange","lightblue"), size =2) +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black", size =1) +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- pie1 %>%
arrange(desc(group)) %>%
mutate(ypos = c(900,500))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 2, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
gplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 0.5, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 0.5, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 1.3, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 1.1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="none") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position=1) +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- data.frame(group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- pie1 %>%
arrange(desc(group)) %>%
mutate(ypos = c(900,500))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = group), color = "white", size=6)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1
pie1 <- data.frame(group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(group)) %>%
mutate(prop = value / sum(data$value) *100) %>%
mutate(ypos = c(900,500))
pie1 <- data.frame(group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(group)) %>%
mutate(prop = amount / sum(data$value) *100) %>%
mutate(ypos = c(900,500))
pie1 <- data.frame(group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(group)) %>%
mutate(prop = amount / sum(pie1$amount) *100) %>%
mutate(ypos = c(900,500))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = prop ), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount ), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(900,500))
ggplot(pie1, aes(x="", y=amount, fill=group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount ), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(500, 900))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(350, 900))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
pie1
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(410, 905.5))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
#scale_fill_brewer(palette="Set2")+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "black", size=5)+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
pie1
mapped
view(mapped)
View(mapped)
mapped[1,]
for (i in mapped[,1]){
if (mapped[i,4] == 0 & mapped[i,5] == 0){
print("jap")
}
}
for (i in mapped[,1]){
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
}
for (i in mapped[,1]){
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
for (i in length(mapped[,1])){
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
for (i in length(mapped[,1])){
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
length(mapped[,1])
while (i < length(mapped[,1])){
i <- i++
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
while (i < length(mapped[,1])){
i <- i++
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
i = 0
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
(mapped[i,4]
mapped[i,4]
mapped[,4]
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
mapped <- read.csv("output/2023-01-27_NC_000913.3 Escherichia coli str. K-12 substr. MG1655, complete genome.csv",sep = ";")
# mapped = mapped[50:60,]
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
mapped %>% str()
View(mapped)
i = 0
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]= 0) & (mapped[i,5] = 0)){
print("jap")
}
else{
print("nope")
}
}
mapped <- read.csv("output/2023-01-27_NC_000913.3 Escherichia coli str. K-12 substr. MG1655, complete genome.csv",sep = ";")
# mapped = mapped[50:60,]
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
mapped %>% str()
i = 0
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
print("jap")
}
else{
print("nope")
}
}
i = 0
pie2$Group <-  c("")
i = 0
pie2 <- data.frame("Group" =  c("No Hit", "Hit"), "value" = c(0,0)
while (i < length(mapped[,1])){
i = 0
pie2 <- data.frame("Group" =  c("No Hit", "Hit"), "value" = c(0,0))
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie2$value[0] <- pie2$value[0]+1
}
else{
pie2$value[1] <- pie2$value[1]+1
}
}
```
i = 0
pie2 <- data.frame("Group" =  c("No Hit", "Hit"), "value" = c(0,0))
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie2$value[0] <- pie2$value[0]+1
}
else{
pie2$value[1] <- pie2$value[1]+1
}
}
pie2
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
i = 0
pie2 <- data.frame("Group" =  c("No Hit", "Hit"), "value" = c(0,0))
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie2$value[0] <- pie2$value[0]+1
}
else{
pie2$value[1] <- pie2$value[1]+1
}
}
pie2
pie2$value[0]
i = 1
pie2 <- data.frame("Group" =  c("No Hit", "Hit"), "value" = c(0,0))
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie2$value[1] <- pie2$value[1]+1
}
else{
pie2$value[2] <- pie2$value[2]+1
}
}
pie2
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
#geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
pie2$ypos <- c(pie2$value[1]/2, pie2$value[2]/2+pie2$value[1])
pie2
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = value), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
geom_text(aes(x = 1, y = ypos, label = "none"), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= elemnt_blank()) +
geom_text(aes(x = 1, y = ypos, label = "value"), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = "value"), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))
```
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 3: Number of successful mappings to sense or anti-sense strand.")
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = "value"), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
```
ggplot(pie2, aes(x="", y=value, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = value), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
