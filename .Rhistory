theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(MapNum, aes(x="", y=Hits, fill=Mappings)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
#scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(MapNum, aes(x="", y=Hits, fill=Mappings)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(MapNum, aes(x="", y=Hits, fill=Factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(MapNum, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
scale_fill_manual(values= c("pastelblue", "red"))+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
#scale_fill_manual(values= c("blue", "red"))+
scale_fill_brewer(palette="Set1")+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
```
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
#scale_fill_manual(values= c("blue", "red"))+
scale_fill_brewer(palette="Pastel1")+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
library(ggrepel)
install.packages("ggrepel")
install.packages("tidyverse")
df2 <- MapNum %>%
mutate(csum = rev(cumsum(rev(Hits))),
pos = Hits/2 + lead(csum, 1),
pos = if_else(is.na(pos), value/2, pos))
df2 <- MapNum %>%
mutate(csum = rev(cumsum(rev(Hits))),
pos = Hits/2 + lead(csum, 1),
pos = if_else(is.na(pos), Hits/2, pos))
df2
ggplot(df, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(df2, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
library(ggrepel)
library(tidyverse)
ggplot(df2, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(value, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(df2, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Set1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(df2, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
ggplot(df2, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
MapNum <- data.frame("Mappings" = 0, "Hits" = 0)
for(i in (1:length(mapped[,6]))){
if (mapped[i,6] %in% MapNum[,1]){
pos = which(MapNum[,1] == mapped[i,6])
MapNum[pos,2] <- (MapNum[pos,2]+1)
} else{
newline <- c(mapped[i,6],1)
MapNum <- rbind(MapNum, newline)
}
}
MapNum$Fraction <- MapNum[,2]/sum(MapNum[,2])*100
MapNum <- MapNum %>%
mutate(csum = rev(cumsum(rev(Hits))),
pos = Hits/2 + lead(csum, 1),
pos = if_else(is.na(pos), Hits/2, pos))
ggplot(MapNum, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
library(ggplot2)
library(dplyr)
library(purrr)
library(ggrepel)
library(tidyverse)
if (!require(ape)) {
install.packages("ape")
library(ape)
}
if (!require(ggrepel)) {
install.packages("ggrepel")
library(ggrepel)
}
if (!require(tidyverse)) {
install.packages("tidyverse")
library(tidyverse)
}
genome <- read.dna("data/Ecoli_genome.fasta",format="fasta")
sequence <- as.character(genome)
genome_length <- length(sequence)
mapped <- read.csv("output/2023-01-27_NC_000913.3 Escherichia coli str. K-12 substr. MG1655, complete genome.csv",sep = ";")
# mapped = mapped[50:60,]
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
mapped %>% str()
sense = unlist(mapped$Sense)
anti = unlist(mapped$Antisense)
sense %>% length()
anti %>% length()
reads <- data.frame(pos = c(sense, anti), strand = as.factor(rep(c("s","a"),times = c(length(sense),length(anti)))))
#pie charts
#mappings Sense vs Antisense
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(pie1$amount[1]/2, pie1$amount[2]/2+pie1$amount[1]))
#Hits vs No Hits
i = 1
pie1$Group2 <- c("No Hit", "Hit")
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie1$value[1] <- pie2$value[1]+1
}
else{
pie1$value[2] <- pie2$value[2]+1
}
}
pie1$ypos2 <- c(pie1$value[1]/2, pie1$value[2]/2+pie1$value[1])
#Map amount
MapNum <- data.frame("Mappings" = 0, "Hits" = 0)
for(i in (1:length(mapped[,6]))){
if (mapped[i,6] %in% MapNum[,1]){
pos = which(MapNum[,1] == mapped[i,6])
MapNum[pos,2] <- (MapNum[pos,2]+1)
} else{
newline <- c(mapped[i,6],1)
MapNum <- rbind(MapNum, newline)
}
}
MapNum$Fraction <- MapNum[,2]/sum(MapNum[,2])*100
MapNum <- MapNum %>%
mutate(csum = rev(cumsum(rev(Hits))),
pos = Hits/2 + lead(csum, 1),
pos = if_else(is.na(pos), Hits/2, pos))
ggplot(reads, aes(x = pos, y = ..density..)) +
geom_histogram(bins = 155, color = "green4", fill = "green2") +
geom_density(color = "darkgreen", lwd=1.3, bw = 70000)+
# geom_histogram(reads)
labs(x = "Genome Position in Mb", y = "Density of reads mapped", caption = "Fig. 1: Density of the reads mapped to the E.coli genome.") +
# scale_y_reverse(limits = c(0,12)) +
theme_classic() +
theme(text = element_text(size = 20))
ggplot(reads) +
geom_histogram(data = reads[reads$strand == "s",],aes(x = pos/10^6, y = ..count..), bins = 155,color="lightblue",fill="blue") +
# geom_density(data = reads[reads$strand == "s",], color="lightblue") +
geom_histogram(data = reads[reads$strand == "a",],aes(x = pos/10^6, y = -..count..), bins = 155,color="orange",fill="red") +
scale_y_continuous(labels = abs) +
labs(x = "Genome Position in Mb", y = "reads mapped per 30 Kb segment", caption = "Fig 2: Orientation of mapped Reads") +
theme_classic() +
theme(text = element_text(size = 20))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 3: Number of successful mappings to sense and anti-sense strand.")
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
#scale_fill_manual(values= c("blue", "red"))+
scale_fill_brewer(palette="Pastel1")+
labs(caption = "Fig 4: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
ggplot(MapNum, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
View(pie1)
sense
sum(mapped[,4] != 0)
sum(mapped[,4])
pie1 <- data.frame(Group3 = c("Sense", "Anti-Sense"), Reads = c(sum(mapped[,4] != 0),sum(mapped[,5] != 0)))
pie1 <- pie1 %>%
arrange(desc(Group3)) %>%
mutate(ypos = c(pie1$Reads[1]/2, pie1$Reads[2]/2+pie1$Reads[1]))
View(pie1)
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(pie1$amount[1]/2, pie1$amount[2]/2+pie1$amount[1]))
#Hits vs No Hits
i = 1
pie1$Group2 <- c("No Hit", "Hit")
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie1$value[1] <- pie2$value[1]+1
}
else{
pie1$value[2] <- pie2$value[2]+1
}
}
pie1$ypos2 <- c(pie1$value[1]/2, pie1$value[2]/2+pie1$value[1])
#Succesful apped Reads Sense vs Antisense
pie1 <- data.frame(Group3 = c("Sense", "Anti-Sense"), Reads = c(sum(mapped[,4] != 0),sum(mapped[,5] != 0)))
pie1 <- pie1 %>%
arrange(desc(Group3)) %>%
mutate(ypos3 = c(pie1$Reads[1]/2, pie1$Reads[2]/2+pie1$Reads[1]))
View(pie1)
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(pie1$amount[1]/2, pie1$amount[2]/2+pie1$amount[1]))
#Hits vs No Hits
i = 1
pie1$Group2 <- c("No Hit", "Hit")
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie1$value[1] <- pie2$value[1]+1
}
else{
pie1$value[2] <- pie2$value[2]+1
}
}
pie1$ypos2 <- c(pie1$value[1]/2, pie1$value[2]/2+pie1$value[1])
#Succesful apped Reads Sense vs Antisense
pie1 <- data.frame(Group3 = c("Sense", "Anti-Sense"), Reads = c(sum(mapped[,4] != 0),sum(mapped[,5] != 0)))
pie1$ypos3 <- c(pie1$Reads[1]/2, pie1$Reads[2]/2+pie1$Reads[1])
View(pie1)
#Hits Sense vs Antisense
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(pie1$amount[1]/2, pie1$amount[2]/2+pie1$amount[1]))
#Hits vs No Hits
i = 1
pie1$Group2 <- c("No Hit", "Hit")
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie1$value[1] <- pie2$value[1]+1
}
else{
pie1$value[2] <- pie2$value[2]+1
}
}
pie1$ypos2 <- c(pie1$value[1]/2, pie1$value[2]/2+pie1$value[1])
#Succesful apped Reads Sense vs Antisense
pie1$Group3 = c("Sense", "Anti-Sense")
pie1$Reads = c(sum(mapped[,4] != 0),sum(mapped[,5] != 0))
pie1$ypos3 <- c(pie1$Reads[1]/2, pie1$Reads[2]/2+pie1$Reads[1])
View(pie1)
ggplot(pie1, aes(x="", y=Reads, fill=Group3)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos3, label = Reads), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 4: Succesful mapped Reads Sense vs Antisense.")
library(ggplot2)
library(dplyr)
library(purrr)
library(ggrepel)
library(tidyverse)
if (!require(ape)) {
install.packages("ape")
library(ape)
}
if (!require(ggrepel)) {
install.packages("ggrepel")
library(ggrepel)
}
if (!require(tidyverse)) {
install.packages("tidyverse")
library(tidyverse)
}
genome <- read.dna("data/Ecoli_genome.fasta",format="fasta")
sequence <- as.character(genome)
genome_length <- length(sequence)
mapped <- read.csv("output/2023-01-27_NC_000913.3 Escherichia coli str. K-12 substr. MG1655, complete genome.csv",sep = ";")
# mapped = mapped[50:60,]
mapped = mapped %>% mutate_at(vars(Sense, Antisense), ~map(strsplit(. ,split=","), ~map_int(.x, as.integer)))
mapped %>% str()
sense = unlist(mapped$Sense)
anti = unlist(mapped$Antisense)
sense %>% length()
anti %>% length()
reads <- data.frame(pos = c(sense, anti), strand = as.factor(rep(c("s","a"),times = c(length(sense),length(anti)))))
#pie charts
#Hits Sense vs Antisense
pie1 <- data.frame(Group = c("Sense", "Anti-Sense"), amount = c(length(sense),length(anti)))
pie1 <- pie1 %>%
arrange(desc(Group)) %>%
mutate(ypos = c(pie1$amount[1]/2, pie1$amount[2]/2+pie1$amount[1]))
#Hits vs No Hits
i = 1
pie1$Group2 <- c("No Hit", "Hit")
while (i < length(mapped[,1])){
i <- i+1
if ((mapped[i,4]== 0) & (mapped[i,5] == 0)){
pie1$value[1] <- pie2$value[1]+1
}
else{
pie1$value[2] <- pie2$value[2]+1
}
}
pie1$ypos2 <- c(pie1$value[1]/2, pie1$value[2]/2+pie1$value[1])
#Succesful mapped Reads Sense vs Antisense
pie1$Group3 = c("Sense", "Anti-Sense")
pie1$Reads = c(sum(mapped[,4] != 0),sum(mapped[,5] != 0))
pie1$ypos3 <- c(pie1$Reads[1]/2, pie1$Reads[2]/2+pie1$Reads[1])
#Map amount
MapNum <- data.frame("Mappings" = 0, "Hits" = 0)
for(i in (1:length(mapped[,6]))){
if (mapped[i,6] %in% MapNum[,1]){
pos = which(MapNum[,1] == mapped[i,6])
MapNum[pos,2] <- (MapNum[pos,2]+1)
} else{
newline <- c(mapped[i,6],1)
MapNum <- rbind(MapNum, newline)
}
}
MapNum$Fraction <- MapNum[,2]/sum(MapNum[,2])*100
MapNum <- MapNum %>%
mutate(csum = rev(cumsum(rev(Hits))),
pos = Hits/2 + lead(csum, 1),
pos = if_else(is.na(pos), Hits/2, pos))
ggplot(reads, aes(x = pos, y = ..density..)) +
geom_histogram(bins = 155, color = "green4", fill = "green2") +
geom_density(color = "darkgreen", lwd=1.3, bw = 70000)+
# geom_histogram(reads)
labs(x = "Genome Position in Mb", y = "Density of reads mapped", caption = "Fig. 1: Density of the reads mapped to the E.coli genome.") +
# scale_y_reverse(limits = c(0,12)) +
theme_classic() +
theme(text = element_text(size = 20))
ggplot(reads) +
geom_histogram(data = reads[reads$strand == "s",],aes(x = pos/10^6, y = ..count..), bins = 155,color="lightblue",fill="blue") +
# geom_density(data = reads[reads$strand == "s",], color="lightblue") +
geom_histogram(data = reads[reads$strand == "a",],aes(x = pos/10^6, y = -..count..), bins = 155,color="orange",fill="red") +
scale_y_continuous(labels = abs) +
labs(x = "Genome Position in Mb", y = "reads mapped per 30 Kb segment", caption = "Fig 2: Orientation of mapped Reads") +
theme_classic() +
theme(text = element_text(size = 20))
ggplot(pie1, aes(x="", y=amount, fill=Group)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos, label = amount), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 3: Number of successful mappings to sense and anti-sense strand.")
ggplot(pie1, aes(x="", y=Reads, fill=Group3)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos3, label = Reads), color = "white", size=5)+
scale_fill_manual(values= c("blue", "red"))+
labs(caption = "Fig 4: Successful mapped Reads Sense vs Antisense.")
ggplot(pie1, aes(x="", y=value, fill=Group2)) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
geom_text(aes(x = 1, y = ypos2, label = value), color = "white", size=5)+
#scale_fill_manual(values= c("blue", "red"))+
scale_fill_brewer(palette="Pastel1")+
labs(caption = "Fig 5: Number of reads that could be mapped to the gnome vs. number of reads that could not be mapped.")
ggplot(MapNum, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 6: Fraction of Reads by Number of Hits.")
ggplot(MapNum, aes(x="", y=Hits, fill=factor(Mappings))) +
geom_bar(stat="identity", width=1, color = "black") +
coord_polar("y", start=0)+
theme_void()+
theme(legend.position="top") +
theme(legend.title= element_blank()) +
scale_fill_brewer(palette="Pastel1")+
geom_label_repel(data = df2,
aes(y = pos, label = paste0(Fraction, "%")),
size = 4.5, nudge_x = 1, show.legend = FALSE) +
labs(caption = "Fig 5: Fraction of Reads by Number of Hits.")
